# ä¿®å¤ - èœå•æ ‘å½¢ç»“æ„ä¸¢å¤± âœ…

## ğŸ› é—®é¢˜

å‰ç«¯èœå•æ ‘å½¢å¤±æ•ˆï¼Œåªæ˜¾ç¤ºä¸€å±‚ï¼Œå­èœå•æ— æ³•å±•å¼€ã€‚

**ç°è±¡**:
```
èœå•ç®¡ç†
â”œâ”€â”€ dashboard  âœ…
â”œâ”€â”€ basic      âŒ åº”è¯¥æœ‰å­èœå•ï¼Œä½†æ²¡æœ‰å±•å¼€
â””â”€â”€ system     âŒ åº”è¯¥æœ‰å­èœå•ï¼Œä½†æ²¡æœ‰å±•å¼€
```

## ğŸ” åŸå› 

**auth æœåŠ¡è¿”å›èœå•æ—¶ï¼Œç¼ºå°‘äº† `id` å’Œ `pid` å­—æ®µ**

å‰ç«¯éœ€è¦ `id` å’Œ `pid` æ¥æ„å»ºæ ‘å½¢ç»“æ„ï¼š
- `id`: èœå•çš„å”¯ä¸€æ ‡è¯†
- `pid`: çˆ¶èœå•çš„ idï¼ˆç”¨äºç¡®å®šçˆ¶å­å…³ç³»ï¼‰

### é—®é¢˜ä»£ç 

**`app/auth/services/auth.go:400-409`**

```go
// âŒ è½¬æ¢æ—¶ç¼ºå°‘ ID å’Œ PID
for _, menu := range menus {
    routes = append(routes, dto.RouteItem{
        Name:          menu.Name,
        Path:          menu.Path,
        Title:         menu.Title,
        RequiresAuth:  menu.RequiresAuth,
        Icon:          menu.Icon,
        MenuType:      menu.MenuType,
        ComponentPath: menu.ComponentPath,
        // âŒ ç¼ºå°‘ ID
        // âŒ ç¼ºå°‘ PID
    })
}
```

---

## âœ… è§£å†³æ–¹æ¡ˆ

**åœ¨è½¬æ¢èœå•æ—¶ï¼ŒåŒ…å«æ‰€æœ‰å¿…è¦å­—æ®µï¼Œç‰¹åˆ«æ˜¯ `ID` å’Œ `PID`**

### ä¿®æ”¹ä»£ç 

**`app/auth/services/auth.go`**

```go
// âœ… åŒ…å«å®Œæ•´å­—æ®µ
for _, menu := range menus {
    routes = append(routes, dto.RouteItem{
        ID:            menu.ID,            // âœ… èœå• ID
        PID:           menu.PID,           // âœ… çˆ¶èœå• ID
        Name:          menu.Name,
        Path:          menu.Path,
        Title:         menu.Title,
        RequiresAuth:  menu.RequiresAuth,
        Icon:          menu.Icon,
        MenuType:      menu.MenuType,
        ComponentPath: menu.ComponentPath,
        Redirect:      menu.Redirect,
        Roles:         menu.Roles,
        KeepAlive:     menu.KeepAlive,
        Hide:          menu.Hide,
        Order:         menu.Order,
        Href:          menu.Href,
        ActiveMenu:    menu.ActiveMenu,
    })
}
```

---

## ğŸš€ é‡å¯ auth æœåŠ¡

```powershell
# åœæ­¢ auth æœåŠ¡ï¼ˆCtrl+Cï¼‰

# é‡å¯
go run cmd/auth/main.go
```

---

## ğŸ¯ éªŒè¯

### 1. æ£€æŸ¥ API è¿”å›

**GET `/auth/getUserRoutes`** åº”è¯¥è¿”å›ï¼š

```json
{
  "code": 0,
  "data": {
    "routes": [
      {
        "id": "68ddf8dfc09a1d346c845ced",
        "pid": null,
        "name": "dashboard",
        "path": "/dashboard",
        "title": "ä»ªè¡¨ç›˜",
        ...
      },
      {
        "id": "68ddf8dfc09a1d346c845cee",
        "pid": null,
        "name": "basic",
        "path": "/basic",
        "title": "åŸºç¡€ä¿¡æ¯",
        "menuType": "dir",
        ...
      },
      {
        "id": "68ddf8dfc09a1d346c845cef",
        "pid": "68ddf8dfc09a1d346c845cee",  â† æŒ‡å‘ basic çš„ id
        "name": "color",
        "path": "/basic/color",
        "title": "é¢œè‰²ç®¡ç†",
        ...
      }
    ]
  }
}
```

### 2. å‰ç«¯æ˜¾ç¤º

**èœå•ç®¡ç†** åº”è¯¥æ­£ç¡®æ˜¾ç¤ºæ ‘å½¢ç»“æ„ï¼š

```
èœå•ç®¡ç†
â”œâ”€â”€ dashboard
â”œâ”€â”€ basic
â”‚   â”œâ”€â”€ color       âœ…
â”‚   â”œâ”€â”€ size        âœ…
â”‚   â”œâ”€â”€ customer    âœ…
â”‚   â””â”€â”€ ...
â””â”€â”€ system
    â”œâ”€â”€ admin       âœ…
    â”œâ”€â”€ role        âœ…
    â””â”€â”€ ...
```

---

## ğŸ“ æ ‘å½¢ç»“æ„åŸç†

å‰ç«¯é€šè¿‡ `id` å’Œ `pid` æ„å»ºæ ‘ï¼š

```javascript
// ç¤ºä¾‹æ•°æ®
const menus = [
  { id: '1', pid: null, name: 'basic', ... },      // é¡¶çº§èœå•
  { id: '2', pid: '1', name: 'color', ... },       // basic çš„å­èœå•
  { id: '3', pid: '1', name: 'size', ... },        // basic çš„å­èœå•
]

// å‰ç«¯æ„å»ºæ ‘
basic (id=1, pid=null)
â”œâ”€â”€ color (id=2, pid=1)  â† pid æŒ‡å‘ basic çš„ id
â””â”€â”€ size  (id=3, pid=1)  â† pid æŒ‡å‘ basic çš„ id
```

**å¦‚æœç¼ºå°‘ `id` å’Œ `pid`ï¼Œå‰ç«¯æ— æ³•åˆ¤æ–­çˆ¶å­å…³ç³»ï¼** âŒ

---

## ğŸ‰ å®Œæˆ

ä¿®å¤åï¼Œèœå•åº”è¯¥ï¼š
- âœ… æ­£ç¡®æ˜¾ç¤ºæ ‘å½¢ç»“æ„
- âœ… å­èœå•å¯ä»¥å±•å¼€/æ”¶èµ·
- âœ… èœå•å±‚çº§å…³ç³»æ­£ç¡®

**é‡å¯ auth æœåŠ¡å¹¶åˆ·æ–°æµè§ˆå™¨æµ‹è¯•ï¼** ğŸš€
